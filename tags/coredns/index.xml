<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>coredns on </title>
    <link>https://blog.mletter.cn/tags/coredns/</link>
    <description>Recent content in coredns on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Sun, 26 Feb 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.mletter.cn/tags/coredns/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CacheDNS和DNS缓存</title>
      <link>https://blog.mletter.cn/posts/coredns/</link>
      <pubDate>Sun, 26 Feb 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.mletter.cn/posts/coredns/</guid>
      <description>如果在集群规模较大并发较高的情况下我们仍然需要对 DNS 进行优化，典型的就是大家比较熟悉的 CoreDNS 会出现超时5s的情况。
超时原因 在 iptables 模式下（默认情况下），每个服务的 kube-proxy 在主机网络名称空间的 nat 表中创建一些 iptables 规则。 比如在集群中具有两个 DNS 服务器实例的 kube-dns 服务，其相关规则大致如下所示：
1(1) -A PREROUTING -m comment --comment &amp;#34;kubernetes service portals&amp;#34; -j KUBE-SERVICES 2&amp;lt;...&amp;gt; 3(2) -A KUBE-SERVICES -d 10.96.0.10/32 -p udp -m comment --comment &amp;#34;kube-system/kube-dns:dns cluster IP&amp;#34; -m udp --dport 53 -j KUBE-SVC-TCOU7JCQXEZGVUNU 4&amp;lt;...&amp;gt; 5(3) -A KUBE-SVC-TCOU7JCQXEZGVUNU -m comment --comment &amp;#34;kube-system/kube-dns:dns&amp;#34; -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-LLLB6FGXBLX6PZF7 6(4) -A KUBE-SVC-TCOU7JCQXEZGVUNU -m comment --comment &amp;#34;kube-system/kube-dns:dns&amp;#34; -j KUBE-SEP-LRVEW52VMYCOUSMZ 7&amp;lt;.</description>
    </item>
    
  </channel>
</rss>
