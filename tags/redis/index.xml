<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Redis on å¤ªé˜³å¯ä»¥æ˜¯è“è‰²</title>
        <link>http://localhost:1313/tags/redis/</link>
        <description>Recent content in Redis on å¤ªé˜³å¯ä»¥æ˜¯è“è‰²</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>Live and learn. ğŸŒ±</copyright>
        <lastBuildDate>Fri, 19 Feb 2021 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/tags/redis/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Redisé›†ç¾¤æ­å»º</title>
        <link>http://localhost:1313/tech/redis/install-redis-cluster/</link>
        <pubDate>Fri, 19 Feb 2021 00:00:00 +0000</pubDate>
        
        <guid>http://localhost:1313/tech/redis/install-redis-cluster/</guid>
        <description>&lt;h2 id=&#34;redis-clusterredisé›†ç¾¤ç®€ä»‹&#34;&gt;&lt;/h&gt;Redis Clusterï¼ˆRedisé›†ç¾¤ï¼‰ç®€ä»‹
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;redisæ˜¯ä¸€ä¸ªå¼€æºçš„key valueå­˜å‚¨ç³»ç»Ÿï¼Œå—åˆ°äº†å¹¿å¤§äº’è”ç½‘å…¬å¸çš„é’çã€‚redis3.0ç‰ˆæœ¬ä¹‹å‰åªæ”¯æŒå•ä¾‹æ¨¡å¼ï¼Œåœ¨3.0ç‰ˆæœ¬åŠä»¥åæ‰æ”¯æŒé›†ç¾¤ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯redis3.0.0ç‰ˆæœ¬ï¼›&lt;/li&gt;
&lt;li&gt;redisé›†ç¾¤é‡‡ç”¨P2Pæ¨¡å¼ï¼Œæ˜¯å®Œå…¨å»ä¸­å¿ƒåŒ–çš„ï¼Œä¸å­˜åœ¨ä¸­å¿ƒèŠ‚ç‚¹æˆ–è€…ä»£ç†èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;redisé›†ç¾¤æ˜¯æ²¡æœ‰ç»Ÿä¸€çš„å…¥å£çš„ï¼Œå®¢æˆ·ç«¯ï¼ˆclientï¼‰è¿æ¥é›†ç¾¤çš„æ—¶å€™è¿æ¥é›†ç¾¤ä¸­çš„ä»»æ„èŠ‚ç‚¹ï¼ˆnodeï¼‰å³å¯ï¼Œé›†ç¾¤å†…éƒ¨çš„èŠ‚ç‚¹æ˜¯ç›¸äº’é€šä¿¡çš„ï¼ˆPING-PONGæœºåˆ¶ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªrediså®ä¾‹ï¼›&lt;/li&gt;
&lt;li&gt;ä¸ºäº†å®ç°é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œå³åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å¥åº·ï¼ˆèƒ½å¦æ­£å¸¸ä½¿ç”¨ï¼‰ï¼Œredis-clusteræœ‰è¿™ä¹ˆä¸€ä¸ªæŠ•ç¥¨å®¹é”™æœºåˆ¶ï¼šå¦‚æœé›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æŠ•ç¥¨è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±æŒ‚äº†ï¼ˆfailï¼‰ã€‚è¿™æ˜¯åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æŒ‚äº†çš„æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­é›†ç¾¤æ˜¯å¦æŒ‚äº†å‘¢? -&amp;gt; å¦‚æœé›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œè€Œä¸”è¯¥èŠ‚ç‚¹æ²¡æœ‰ä»èŠ‚ç‚¹ï¼ˆå¤‡ä»½èŠ‚ç‚¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªé›†ç¾¤å°±æŒ‚äº†ã€‚è¿™æ˜¯åˆ¤æ–­é›†ç¾¤æ˜¯å¦æŒ‚äº†çš„æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆä¸ºä»€ä¹ˆä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼ˆæ²¡æœ‰ä»èŠ‚ç‚¹ï¼‰è¿™ä¸ªé›†ç¾¤å°±æŒ‚äº†å‘¢ï¼Ÿ -&amp;gt; å› ä¸ºé›†ç¾¤å†…ç½®äº†16384ä¸ªslotï¼ˆå“ˆå¸Œæ§½ï¼‰ï¼Œå¹¶ä¸”æŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°äº†è¿™16384[0-16383]ä¸ªslotä¸Šï¼Œæˆ–è€…è¯´æŠŠè¿™äº›slotå‡ç­‰çš„åˆ†é…ç»™äº†å„ä¸ªèŠ‚ç‚¹ã€‚å½“éœ€è¦åœ¨Redisé›†ç¾¤å­˜æ”¾ä¸€ä¸ªæ•°æ®ï¼ˆkey-valueï¼‰æ—¶ï¼Œredisä¼šå…ˆå¯¹è¿™ä¸ªkeyè¿›è¡Œcrc16ç®—æ³•ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªç»“æœã€‚å†æŠŠè¿™ä¸ªç»“æœå¯¹16384è¿›è¡Œæ±‚ä½™ï¼Œè¿™ä¸ªä½™æ•°ä¼šå¯¹åº”[0-16383]å…¶ä¸­ä¸€ä¸ªæ§½ï¼Œè¿›è€Œå†³å®škey-valueå­˜å‚¨åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸­ã€‚æ‰€ä»¥ä¸€æ—¦æŸä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œè¯¥èŠ‚ç‚¹å¯¹åº”çš„slotå°±æ— æ³•ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´é›†ç¾¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œæ¯ä¸ªRedisé›†ç¾¤ç†è®ºä¸Šæœ€å¤šå¯ä»¥æœ‰16384ä¸ªèŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Redisé›†ç¾¤è‡³å°‘éœ€è¦3ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæŠ•ç¥¨å®¹é”™æœºåˆ¶è¦æ±‚è¶…è¿‡åŠæ•°èŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†è¯¥èŠ‚ç‚¹æ‰æ˜¯æŒ‚äº†ï¼Œæ‰€ä»¥2ä¸ªèŠ‚ç‚¹æ— æ³•æ„æˆé›†ç¾¤ã€‚
è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¤‡ä»½èŠ‚ç‚¹ï¼Œæ‰€ä»¥Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚å› ä¸ºæˆ‘æ²¡æœ‰é‚£ä¹ˆå¤šæœåŠ¡å™¨ï¼Œä¹Ÿå¯åŠ¨ä¸äº†é‚£ä¹ˆå¤šè™šæ‹Ÿæœºï¼Œæ‰€åœ¨è¿™é‡Œæ­å»ºçš„æ˜¯ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼Œå³ä¸€å°æœåŠ¡å™¨è™šæ‹Ÿè¿è¡Œ6ä¸ªrediså®ä¾‹ï¼Œä¿®æ”¹ç«¯å£å·ä¸ºï¼ˆ7001-7006ï¼‰&lt;code&gt;1+1+1+1+1+1 = 6&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ­å»ºé›†ç¾¤&#34;&gt;&lt;/h&gt;æ­å»ºé›†ç¾¤
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Redisç‰ˆæœ¬&lt;code&gt;6.0.8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Gcc7x.x.x&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åˆ›å»ºç›®å½•&#34;&gt;&lt;/h&gt;åˆ›å»ºç›®å½•
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir /usr/local/redis-cluster
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /usr/local/redis-cluster
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wget http://download.redis.io/releases/redis-6.0.8.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;7001..7006&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¤åˆ¶é…ç½®æ–‡ä»¶&#34;&gt;&lt;/h&gt;å¤åˆ¶é…ç½®æ–‡ä»¶
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tar -zxf redis-6.0.8.tar.gz
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; redis-6.0.8/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make install 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp -a redis-6.0.8/redis.conf 7001/ &lt;span class=&#34;c1&#34;&gt;# ä»¥æ­¤ç±»æ¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp -a redis-6.0.8/redis.conf 7002/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;å¦‚æœä½ ä¸æƒ³ç¼–è¯‘å®‰è£…çš„è¯,ä½ å¯ä»¥æŠŠredisä¸­çš„/binç›®å½•çš„å‘½ä»¤ç§»åŠ¨åˆ°æ¯ä¸ªnodeèŠ‚ç‚¹æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™æ ·ä»¥æ–¹ä¾¿ä½ ä½¿ç”¨&lt;code&gt;redis-server&lt;/code&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¼–è¾‘é…ç½®æ–‡ä»¶&#34;&gt;&lt;/h&gt;ç¼–è¾‘é…ç½®æ–‡ä»¶
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;æ­¤æ–‡ä»¶å†…å®¹ä¸ºé›†ç¾¤æ¨¡å¼æœ€å°é…ç½®æ–‡ä»¶å†…å®¹.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vim 7001/redis.conf &lt;span class=&#34;c1&#34;&gt;# ä»¥æ­¤ç±»æ¨,è®°å¾—æ›´æ”¹ç«¯å£å·å’Œæ—¥å¿—æ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt; 127.0.0.1 &lt;span class=&#34;c1&#34;&gt;# IPå¯æ›´æ¢ä¸ºå†…ç½‘IP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;port &lt;span class=&#34;m&#34;&gt;7001&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cluster-enabled yes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cluster-config-file nodes7001.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cluster-node-timeout &lt;span class=&#34;m&#34;&gt;5000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;appendonly yes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;daemonize yes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;logfile /usr/local/redis-cluster/7001/redis-7001.log
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;maxmemory 4GB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;requirepass *******
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;dir /usr/local/redis-cluster/7001
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;masterauth ****
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;port 7001&lt;/code&gt; Redisè¿è¡Œç«¯å£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cluster-enabled yes&lt;/code&gt;å¯ç”¨é›†ç¾¤æ¨¡å¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cluster-config-file nodes.conf&lt;/code&gt;é›†ç¾¤æ¨¡å¼é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cluster-node-timeout 5000&lt;/code&gt;èŠ‚ç‚¹çš„è¶…æ—¶æ—¶é™&lt;/li&gt;
&lt;li&gt;&lt;code&gt;appendonly yes&lt;/code&gt;å¼€å¯AOFæŒä¹…åŒ–&lt;/li&gt;
&lt;li&gt;&lt;code&gt;daemonize yes&lt;/code&gt;å¼€å¯åå°è¿è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;maxmemory 4GB&lt;/code&gt;Redisæœ€å¤§å¯ç”¨å†…å­˜&lt;/li&gt;
&lt;li&gt;&lt;code&gt;requirepass&lt;/code&gt;è¿æ¥Rediså®¢æˆ·ç«¯å¯†ç &lt;/li&gt;
&lt;li&gt;&lt;code&gt;masterauth&lt;/code&gt; Slaveè¿æ¥masteréœ€è¦çš„è®¤è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¯åŠ¨é›†ç¾¤&#34;&gt;&lt;/h&gt;å¯åŠ¨é›†ç¾¤
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;è‡ªå·±å»ºä¸€ä¸ªå¯åŠ¨è„šæœ¬,è¦ä¸ç„¶æ‰‹åŠ¨å¯åŠ¨å¤ªéº»çƒ¦äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;redis-server /usr/local/redis-cluster/7001/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-server /usr/local/redis-cluster/7002/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-server /usr/local/redis-cluster/7003/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-server /usr/local/redis-cluster/7004/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-server /usr/local/redis-cluster/7005/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-server /usr/local/redis-cluster/7006/redis.conf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;chmod +x start.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sh start.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@bogon redis-cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ps -aux | grep redis&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65558&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;64864&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;6256&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7001 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65564&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;61792&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;4760&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7002 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65566&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;61792&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;4736&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7003 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65572&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;61792&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;4712&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7004 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65578&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;61792&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;4704&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7005 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;65580&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;61792&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;4780&lt;/span&gt; ?        Ssl  09:54   0:00 redis-server *:7006 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åŠ å…¥é›†ç¾¤&#34;&gt;&lt;/h&gt;åŠ å…¥é›†ç¾¤
&lt;/h3&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰è®¸å¤šå®ä¾‹æ­£åœ¨è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å‘èŠ‚ç‚¹å†™å…¥ä¸€äº›æœ‰æ„ä¹‰çš„é…ç½®æ¥åˆ›å»ºé›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯&lt;code&gt;Redis 5&lt;/code&gt;æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¿™å¾ˆå®¹æ˜“å®Œæˆï¼Œå› ä¸ºåµŒå…¥åˆ°ä¸­çš„Redis Clusterå‘½ä»¤è¡Œå®ç”¨ç¨‹åºä¸ºæˆ‘ä»¬æä¾›äº†å¸®åŠ©ï¼Œè¯¥å®ç”¨ç¨‹åº&lt;code&gt;redis-cli&lt;/code&gt;å¯ç”¨äºåˆ›å»ºæ–°é›†ç¾¤ï¼Œæ£€æŸ¥æˆ–é‡æ–°åˆ†ç‰‡ç°æœ‰é›†ç¾¤ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºRedisç‰ˆæœ¬3æˆ–4ï¼Œæœ‰ä¸€ä¸ªç§°ä¸ºçš„æ—§å·¥å…·&lt;code&gt;redis-trib.rb&lt;/code&gt;ï¼Œå®ƒéå¸¸ç›¸ä¼¼ã€‚æ‚¨å¯ä»¥&lt;code&gt;src&lt;/code&gt;åœ¨Redisæºä»£ç åˆ†å‘çš„ç›®å½•ä¸­æ‰¾åˆ°å®ƒã€‚æ‚¨éœ€è¦å®‰è£…&lt;code&gt;redis&lt;/code&gt;gemæ‰èƒ½è¿è¡Œ&lt;code&gt;redis-trib&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ç”¨çš„æ˜¯Redis3.xæˆ–è€…4.x è¯·å‰å¾€å®˜ç½‘é“¾æ¥ &lt;a class=&#34;link&#34; href=&#34;https://redis.io/topics/cluster-tutorial&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ç‚¹æˆ‘è¿›å…¥&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;æ­¤æ–¹æ³•ä¸º&lt;code&gt;Redis5&lt;/code&gt;æˆ–è€…æ›´é«˜ç‰ˆæœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;--cluster-replicas &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Can I &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; the above configuration? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt; to accept&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: yes
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--cluster-replicas 1&lt;/code&gt;ç»™Masteråªåˆ†é…ä¸€ä¸ªslave&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è¿æ¥é›†ç¾¤&#34;&gt;&lt;/h&gt;è¿æ¥é›†ç¾¤
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-cli -c -p &lt;span class=&#34;m&#34;&gt;7001&lt;/span&gt; -a *** 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:7001&amp;gt; info 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Replication&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role:master
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;connected_slaves:1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:7001&amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; Host Linux7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-&amp;gt; Redirected to slot &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;16156&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; located at 127.0.0.1:7003
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;OK
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-a&lt;/code&gt;æ˜¯ä½ è®¾ç½®çš„requirepasså¯†ç &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼šå‡ºç°connected_slaves:1 è¡¨ç¤ºè¿æ¥åˆ°äº†ä¸€ä¸ªä»æœåŠ¡å™¨ å¦‚æœä¸º0 è¯·æŸ¥çœ‹æœåŠ¡å™¨é”™è¯¯æ—¥å¿—&lt;/p&gt;
&lt;h3 id=&#34;æ•…éšœåˆ‡æ¢&#34;&gt;&lt;/h&gt;æ•…éšœåˆ‡æ¢
&lt;/h3&gt;&lt;p&gt;è¿æ¥åˆ°7003çš„ä»æœåŠ¡å™¨7005 æŸ¥çœ‹æ•°æ®æ˜¯å¦åŒæ­¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis-cli -c -p &lt;span class=&#34;m&#34;&gt;7005&lt;/span&gt; -a ***
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;master_host:127.0.0.1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;master_port:7003
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:7005&amp;gt; get Host
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Linux7&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®•æœº7003æœåŠ¡å™¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@bogon redis-cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ps -aux | grep 7003&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;70467&lt;/span&gt;  0.2  0.0  &lt;span class=&#34;m&#34;&gt;64352&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;5120&lt;/span&gt; ?        Ssl  11:20   0:01 redis-server *:7003 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root       &lt;span class=&#34;m&#34;&gt;70871&lt;/span&gt;  0.0  0.0  &lt;span class=&#34;m&#34;&gt;12112&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;1052&lt;/span&gt; pts/0    S+   11:29   0:00 grep --color&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;auto &lt;span class=&#34;m&#34;&gt;7003&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@bogon redis-cluster&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# kill -15 70467&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡&lt;code&gt;info&lt;/code&gt;å‘ç°7005å·²ç»æˆä¸ºä¸»æœåŠ¡å™¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:7005&amp;gt; info
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Replication&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role:master
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;connected_slaves:0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†æ¬¡å¯åŠ¨7003å‘ç°å·²ç»æ›´æ”¹ä¸ºä»æœåŠ¡å™¨ï¼Œå¹¶ä¸”å·²ç»è¢«7005è¿æ¥åˆ°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:7005&amp;gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Replication&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role:master
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;connected_slaves:1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;/h&gt;æ€»ç»“
&lt;/h2&gt;&lt;p&gt;é¦–å…ˆ å…ˆè¯´ç»“è®ºï¼šredisé›†ç¾¤æ— æ³•ä¿è¯å¼ºä¸€è‡´æ€§&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶æ— æ³•ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰å¯èƒ½å‡ºç°å†™æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸€ä¸ªå®¢æˆ·ç«¯å‘ä¸€ä¸ªå†™è¯·æ±‚ç»™masterï¼Œmasterå†åŒæ­¥åˆ°slaveä¹‹å‰å°±ç»™clientä¸€ä¸ªå›æ‰§ã€‚è¿™ä¸ªæ—¶å€™ä¼šå­˜åœ¨ä¸€ä¸ªæ—¶é—´çª—å£ï¼Œmaster å’Œ slaveä¹‹é—´çš„æ•°æ®æ˜¯ä¸ä¸€è‡´çš„ã€‚ä½†æ˜¯redisçš„æœ€ç»ˆä¸€è‡´æ€§ä¼šä½¿masterå’Œslaveçš„æ•°æ®æ˜¯æœ€ç»ˆä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿˜æœ‰ä¸€ä¸ªå¯èƒ½ï¼Œåœ¨å®¢æˆ·ç«¯æ”¶åˆ°äº†masterçš„ä¸€ä¸ªå†™è¯·æ±‚å›æ‰§ä¹‹åï¼Œæ­¤æ—¶masterå‡†å¤‡æŠŠæ•°æ®åŒæ­¥åˆ°slaveï¼ŒåŒæ­¥ä¹‹å‰çªç„¶æŒ‚äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®çœŸçš„å°±æ˜¯ä¼šä¸¢å¤±äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸ºäº†ä¿è¯å¼ºä¸€è‡´ï¼Œæ¯”å¦‚æˆ‘ä»¬æ¯ç§’åˆ·ç›˜è¿›è¡ŒæŒä¹…åŒ–ï¼Œé‚£ä¹ˆç‰ºç‰²äº†è¿™ä¸ªååé‡ï¼Œå°±ç‰¹åˆ«ç±»ä¼¼æˆ‘ä»¬å¸¸è¯´çš„åŒæ­¥å¤åˆ¶äº†ã€‚ä½†æ˜¯redisé›†ç¾¤æ˜¯æ²¡æœ‰å®ç°å¼ºä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;1ã€redisä¿è¯æœ€ç»ˆä¸€è‡´æ€§&lt;/p&gt;
&lt;p&gt;2ã€ç”¨æœ€ç»ˆä¸€è‡´æ€§æ¢å–äº†é«˜ååé‡&lt;/p&gt;
&lt;p&gt;3ã€ä¸»èŠ‚ç‚¹æŒ‚äº†çš„æ—¶å€™ï¼Œå¦‚æœæ•°æ®æ²¡æœ‰åŒæ­¥åˆ°å¤‡èŠ‚ç‚¹ï¼Œæ˜¯ä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;4ã€å‘ç”Ÿç½‘ç»œåˆ†åŒºçš„æ—¶å€™ä¹Ÿå¯èƒ½ä¼šä¸¢æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ä¸ªnode timeoutæ—¶é—´æ¦‚å¿µ&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
